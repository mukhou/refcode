<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:cs="http://credit-suisse.com/csJsf">

<ui:composition template="../template/page.xhtml">

	<ui:define name="pageTitle">#{message['MICOS.Issues.observationOverview.pagetitle.collectionDetails']}</ui:define>
	<ui:define name="pageHeader">#{message['MICOS.Issues.observationOverview.pagetitle.collectionDetails']}</ui:define>
	<ui:define name="mainContent">
		<ui:include src="baseObservation.xhtml" />
		<h:form id="observationForm"
			binding="#{observationSetupController.init}">
			
			<cs:container id="con1" style="width: 812px;" label="#{message['MICOS.issues.observationSetup.container.label.Observation']}" >
			 
				 <table style="border: 1px solid #006699;"  width="783px;" cellspacing="0" cellpadding="0"><tr><td>
					 
					 <table cellspacing="0" cellpadding="0" style="margin-top:-0.4em;margin-left:0em; margin-botom:-.5em; margin-right:0em; width:794px;" >
					 
					 <div> 
							<tr style="background-color:#7898b3;" >
								<td  style="border-bottom:solid 1px #6699FF;height:.00001em;" > 
								<h:outputText value="&#160;" /><h:outputText value="&#160;" /><h:outputText value="&#160;" />
									<b><h:outputText style="color: white" value="#{observationSetupController.observation.obsReference}" /></b>
									<h:outputText value="&#160;" /><h:outputText value="&#160;" />
									<b><h:outputText style="color: white" value="#{observationSetupController.observation.title}" /></b>
									<h:outputText value="&#160;" /><h:outputText value="&#160;" />
									<h:outputText value="&#160;" /><h:outputText value="&#160;" /></td>
						<td  align="right">	
							
							<h:outputText value="&#160;" /><h:outputText value="&#160;" />
							<h:outputText value="&#160;" /><h:outputText value="&#160;" />
							<h:outputText value="&#160;" /><h:outputText value="&#160;" />
							<h:outputText value="&#160;" /><h:outputText value="&#160;" />
							<h:outputText value="&#160;" /><h:outputText value="&#160;" />
							<h:outputText value="&#160;" /><h:outputText value="&#160;" />
					<c:if 
					test="#{observationSetupController.flagHelper.editObsRendered and observationSetupController.flagHelper.renderButtons}">
						 
						<h:commandButton  
							action="#{observationSetupController.editObservation}" 
							value="#{message['MICOS.issues.observationSetup.button.edit']}" 
							styleClass="button" 
							rendered="true">
							<f:setPropertyActionListener 
								value="#{observationSetupController.helper.readObservationId}" 
								target="#{observationSetupController.helper.readObservationId}" 
								/>
						</h:commandButton> 
					</c:if>	  
						<h:commandButton   
							action="#{observationSetupController.deleteObservation}" 
							value="#{message['MICOS.issues.observationSetup.button.delete']}" 
							disabled="true" styleClass="button" 
							rendered="#{observationSetupController.flagHelper.renderButtons}" 
							onclick="if (!confirm('Are you sure you want to delete observation')) return false">
							<f:setPropertyActionListener 
								value="#{observationSetupController.helper.readObservationId}" 
								target="#{observationSetupController.helper.readObservationId}" 
								/>
						</h:commandButton> 
						 
						 
						 
						
						<h:commandButton  
							action="#{observationSetupController.addRecommendation}" 
							value="#{message['MICOS.issues.observationSetup.button.add']}" 
							styleClass="button" 
							rendered="#{observationSetupController.flagHelper.renderButtons}" 
							/>
                                              </td></tr> </div></table> 
					 	 
					 
					<c:if 
						test="#{observationSetupController.flagHelper.falgEditObservation eq 'true'}">							
								<table>
									<tr>
										<td width="3%">
											<cs:fieldLabel 
												value="#{message['MICOS.issues.createObservation.label.observationReference']}" 
												/>
										</td>
										<td width="2%" align="right">	
											<h:graphicImage 
															alt="#{message['MICOS.Issues.observationDetails.help.observationReference']}" 
															url="${weblet:resource('com.csg.jsf.micIcons','/ico_info_question_16_cli.gif')}" 
															/>
										</td>
										<td width="15%">
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />											
											
											<cs:fieldValue display="mutable" 
												value="#{observationSetupController.observation.obsReference}" 
												size="5" id="_focus" length="10" />
										</td>
									</tr>
									<tr>
										<td width="3%">
											<cs:fieldLabel  
												value="#{message['MICOS.issues.createObservation.label.title']}" 
												/>
										</td>
										<td width="2%" align="right">	
											<h:graphicImage 
															alt="#{message['MICOS.Issues.observationDetails.help.observationTitle']}" 
															url="${weblet:resource('com.csg.jsf.micIcons','/ico_info_question_16_cli.gif')}" 
															/>
										</td>
										<td width="15%">
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											
											<cs:fieldValue display="mutable" size="90" 
												value="#{observationSetupController.observation.title}" 
												 disabled="#" 
												maxlength="200" readonly="false" />
										</td>
									</tr>
									<tr>
										<td width="3%" valign="top">
											<cs:fieldLabel  
												value="#{message['MICOS.issues.createObservation.label.observation']}" 
												/>
										</td>
										<td width="2%" align="right" valign="top">	
											<h:graphicImage  
															alt="#{message['MICOS.Issues.observationDetails.help.observation']}" 
															url="${weblet:resource('com.csg.jsf.micIcons','/ico_info_question_16_cli.gif')}" 
															/>
										</td>
										<td width="15%">
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											
											<h:inputTextarea  style="width:40em;"
												value="#{observationSetupController.observation.observation}" 
												rows="3" disabled="#" cols="75" 
												 readonly="false" maxlength="4000"/>
										</td>
									<h:outputText value="&#160;" />
									</tr>
									</table>
									<table>
									<tr>
										<td width="7%"></td>
										<td width="2%">
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											
											<h:selectBooleanCheckbox 
												value="#{createObservationController.observation.financialRelevancy}" 
												
												rendered="#{observationSetupController.flagHelper.showPotentiallyRelevent}"
												disabled="true"/>
										</td>
										<td width="18%">
											<cs:fieldLabel 
												value="#{message['MICOS.issues.createObservation.label.financialRelevancy']}" 
												/>
										</td>
									</tr>
								</table>
								<table>
								<tr> 
								   <td width="15%"></td>
									<td width="1%">	
										<h:commandButton 
											action="#{observationSetupController.observationCancel}" 
											onclick="if (!confirm('Are you sure you want to move to the Observation Overview page? All unsaved changes will be lost')) return false" 
											value="#{message['MICOS.issues.createObservation.button.cancel']}" 
											styleClass="button" 
											style="height:21px; width:95px;"/>
								        <h:outputText value="&#160;" />
									<h:outputText value="&#160;" />
								  </td>
								  <td width="1%">		
										<h:commandButton 
											action="#{observationSetupController.createObservation}" 
											value="#{message['MICOS.issues.observationSetup.button.save']}" 
											styleClass="button"
											style="height:21px; width:95px;"/>
									</td>
									<td width="1%"><h:outputText value="&#160;" /></td>
								 </tr>
						               </table>
						               <br></br>
								<h:outputText value="&#160;" />
							
						
					</c:if>
					<table border="" cellspacing="0" cellpadding="0"  
						style="margin-top:-0.7em; margin-left:0em; margin-botom:-.5em; margin-right:0em; width:794px;" 
						>
						
						<c:forEach var="rowItem" 
							items="${observationSetupController.observation.recommendationList}">
							<div style="background-color:#B8B8B8;">
							<tr style="background-color:#B8B8B8;" >
								<td  style="border-bottom:solid 1px #6699FF;height:.00001em;" > 
									 
									 
									<h:outputText value="&#160;" />
									<h:outputText value="&#160;" />
									<h:outputText value="&#160;" />
									<h:outputText value="&#160;" />
									<h:outputText value="&#160;" />
									<h:outputText value="&#160;" />
									<h:outputText value="&#160;" />
									<h:outputText value="&#160;" />
									<h:outputText value="&#160;" />
									<b><h:outputText 
										value="#{rowItem.shortRecommendation}" 
										/></b>
								</td>
								<td align="right"  style="border-bottom:solid 1px #6699FF;height:.00001em;" >
									<c:if 
									test="#{rowItem.editRecoRendered and observationSetupController.flagHelper.renderButtons}">
										<h:commandButton 
											action="#{observationSetupController.editRecommendation}" 
											value="#{message['MICOS.issues.observationSetup.button.edit']}" 
											styleClass="button" 
											
											rendered="true">
											<f:setPropertyActionListener 
												value="#{rowItem.id}" 
												target="#{observationSetupController.helper.selectedRecomendationId}" 
												/>
										</h:commandButton>
									</c:if>	
									<h:commandButton 
										action="#{observationSetupController.deleteRecommendation}" 
										value="#{message['MICOS.issues.observationSetup.button.delete']}" 
										onclick="if (!confirm('Are you sure you want to delete this recommendation?')) return false" 
										disabled="true" styleClass="button" 
										
										rendered="#{observationSetupController.flagHelper.renderButtons}">
										<f:setPropertyActionListener 
											value="#{rowItem.id}" 
											target="#{observationSetupController.helper.selectedRecomendationId}" 
											/>
									</h:commandButton>
									<h:commandButton 
										action="#{observationSetupController.addIssue}" 
										value="#{message['MICOS.issues.observationSetup.button.add']}" 
										styleClass="button" 
										
										rendered="#{observationSetupController.flagHelper.renderButtons}" 
										>
										<f:setPropertyActionListener 
											value="#{rowItem.id}" 
											target="#{observationSetupController.helper.selectedRecomendationId}" 
											/>
									</h:commandButton>
								</td>
							</tr></div>
							<c:if test="#{rowItem.flagShowEditReco eq 'true'}">
								<tr style="background-color:white;">
									<td style="border-bottom:solid 1px #6699FF;">
									<table style="margin:0 -.583333333em -.3333em .583333333em;">
										<tr>	
											<td width="1%"></td>
											<td width="3%" align="right">
												<cs:fieldLabel value 
													="#{message['MICOS.issues.observationSetup.label.RecommendationReference']}" 
													/>
											</td>
											<td width="2%" align="right">	
												<h:graphicImage 
												alt="#{message['MICOS.Issues.observationDetails.help.recommendationReference']}" 
												url="${weblet:resource('com.csg.jsf.micIcons','/ico_info_question_16_cli.gif')}" 
												/>
											</td>
											<td width="15%">
												<h:outputText value="&#160;" />
												<h:outputText value="&#160;" />	
												
												<cs:fieldValue 
													display="mutable" 
													value="#{observationSetupController.helper.recommendation.recommendationReference}" 
													size="7" length="10" 
													readonly="false" />
											</td>
										</tr>
										<tr>
											<td width="1%"></td>
											<td width="3%" valign="top">
												<cs:fieldLabel 
													value="#{message['MICOS.issues.observationSetup.label.Recommendation']}" 
													/>
											</td>
											<td width="2%" align="right"  valign="top">	
												<h:graphicImage 
												alt="#{message['MICOS.Issues.observationDetails.help.recommendation']}" 
												url="${weblet:resource('com.csg.jsf.micIcons','/ico_info_question_16_cli.gif')}" 
												/>
											</td>
											<td width="15%">
												<h:outputText value="&#160;" />
												<h:outputText value="&#160;" />	
												
												<h:inputTextarea  
													display="mutable" style="width:38em;"
													readonly="false"
													value="#{observationSetupController.helper.recommendation.recommendation}" 
													rows="3" cols="75" length="4000"/>
											</td>
										</tr>
									</table>
									<table>
										
										<c:choose>
											<c:when 
												test="#{observationSetupController.helper.mode eq 'edit'}">
												<tr></tr>
												<tr></tr>
												<tr></tr>
												<tr></tr>
												<tr></tr>
												<tr></tr>
												<tr>
													<td width="60%"></td>
													<td width="1%">
														<h:commandButton 
															action="#{observationSetupController.observationSetup}" 
															onclick="if (!confirm('Are you sure you want to move to the observation setup page?All unsaved changes will be lost')) return false" 
															value="#{message['MICOS.issues.observationSetup.button.cancel']}" 
															rendered="#{observationSetupController.flagHelper.renderText}" 
															style="height:21px; width:100px;">
															<f:param 
																value="observationSetupController.observation.id" 
																name="readObservationId" 
																/>
														</h:commandButton>
														<h:outputText value="&#160;" />
									                    <h:outputText value="&#160;" />
													</td>
													<td width="15%">											
														<h:commandButton 
															action="#{observationSetupController.saveRecommendation}" 
															value="#{message['MICOS.issues.observationSetup.button.save']}" 
															rendered="#{observationSetupController.flagHelper.renderText}" 
															style="height:21px; width:100px;" />
													</td>
												</tr>
											</c:when>
										</c:choose>
									</table>
									
								</td></tr>
							</c:if>
						
							<div style="background-color:#E8E8E8;">
									
								<c:forEach var="rowItem1" 
									items="${rowItem.listofIssues}">
									<tr 
										style="background-color:#E8E8E8;">
										<td  style="border-bottom:solid 1px #6699FF;height:.00001em;">
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<h:outputText value="&#160;" />
											<b><h:outputText 
												value="#{rowItem1.shortIssueComment}" 
												/></b>
										</td>
										<td align="right" valign="top" style="margin:0 -.583333333em -.3333em -.583333333em;border-bottom:solid 1px #6699FF;height:.00001em;">
											<c:choose>
												<c:when 
													test="${rowItem1.status.code eq 'CLO'}">
													<h:commandButton 
														value="#{message['MICOS.issues.observationSetup.button.edit']}" 
														onclick="return window.showModalDialog('observationSetupPopup.jsf?readId='+#{rowItem1.id},'','dialogHeight:10em;dialogWidth:27em;scroll:no;status:no;help:no;close:no');" 
														action="#{observationSetupController.editPopup}" 
														styleClass="button" 
														rendered="#{observationSetupController.flagHelper.renderButtons}">
														
															<f:setPropertyActionListener 
															value="#{rowItem1.cmbReference}" 
															target="#{observationSetupController.helper.readActionRef}" 
															/>
													</h:commandButton>
												</c:when>
												<c:otherwise>
													<h:commandButton 
														action="#{observationSetupController.editIssue}" 
														value="Edit" 
														styleClass="button" 
														rendered="#{observationSetupController.flagHelper.renderButtons}">
														
															<f:setPropertyActionListener 
															value="#{rowItem1.id}" 
															target="#{observationSetupController.helper.readIssueId}" 
															/>
													</h:commandButton>
												</c:otherwise>
											</c:choose>
											<h:commandButton 
												action="#{observationSetupController.deleteIssue}" 
												value="#{message['MICOS.issues.observationSetup.button.delete']}" 
												onclick="if (!confirm('Are you sure you want to delete this issue?')) return false" 
												styleClass="button" 
												rendered="#{observationSetupController.flagHelper.renderButtons}"
												disabled="true">
												<f:setPropertyActionListener 
													value="#{rowItem1.id}" 
													target="#{observationSetupController.helper.readIssueId}" 
													/>
											</h:commandButton>
											<h:commandButton 
												action="#{observationSetupController.addIssue}" 
												value="#{message['MICOS.issues.observationSetup.button.add']}" 
												disabled="true" 
												styleClass="button" 
												rendered="#{observationSetupController.flagHelper.renderButtons}"/>
										</td>
									</tr>
								</c:forEach>
							</div>				
								 
						</c:forEach>
					</table>
					<c:if test="#{observationSetupController.helper.mode eq 'create'}">
					
					<table cellspacing="0" cellpadding="0"  
					style="margin-top:-0.7em; margin-left:-1em; margin-right:-10em; width:798px;">
					<c:choose>
							<c:when test="#{observationSetupController.flagHelper.flagFirstReco eq 'false'}">
					
								<div  style="background-color:#B8B8B8;">
									<tr   style="background-color:#B8B8B8;">
										<td   width="1%"   style="border-top:solid 1px #6699FF;height:.00001em;"><h:outputText value="&#160;" /></td>
										<td  width="1%"   style="border-top:solid 1px #6699FF;height:.00001em;"><h:outputText value="&#160;" /></td>
										<td  width="1%"   style="border-top:solid 1px #6699FF;height:.00001em;"><h:outputText value="&#160;" /></td>
										
										<td style="border-top:solid 1px #6699FF;height:.00001em;">
											<b><cs:field align="center"
										value="#{message['MICOS.issues.observationSetup.label.newRecommendation']}" 
										rendered="#{observationSetupController.flagHelper.renderLabel}"/></b>
										</td>
								   </tr>	
								</div>	
							</c:when>
							 <c:otherwise>
								<div  style="background-color:#CDDDEB;">
									<tr   style="background-color:#CDDDEB;">
										<td   width="1%"   style="border-top:solid 1px #6699FF;height:.00001em;"><h:outputText value="&#160;" /></td>
										<td  width="1%"   style="border-top:solid 1px #6699FF;height:.00001em;"><h:outputText value="&#160;" /></td>
										<td  width="1%"   style="border-top:solid 1px #6699FF;height:.00001em;"><h:outputText value="&#160;" /></td>
										
										<td style="border-top:solid 1px #6699FF;height:.00001em;">
											<b><cs:field align="center"
										value="#{message['MICOS.issues.observationSetup.label.newRecommendation']}" 
										rendered="#{observationSetupController.flagHelper.renderLabel}"/></b>
										</td>
								   </tr>	
								</div>	
							</c:otherwise>
						</c:choose>		
						</table>
						
					
						<table>
							<tr>
								<td width="1%"></td>
								<td width="3%" align="right">
									<cs:fieldLabel value 
										="#{message['MICOS.issues.observationSetup.label.RecommendationReference']}" 
										/>
								</td>
								<td width="2%" align="right">	
												<h:graphicImage 
												alt="#{message['MICOS.Issues.observationDetails.help.recommendationReference']}" 
												url="${weblet:resource('com.csg.jsf.micIcons','/ico_info_question_16_cli.gif')}" 
												/>
											</td>
								<td width="15%">
									<h:outputText value="&#160;" />
									<h:outputText value="&#160;" />	
									
									<cs:fieldValue display="mutable" 
										value="#{observationSetupController.helper.recommendation.recommendationReference}" 
										size="7" id="_focus" length="10" 
										readonly="false" />
								</td>
							</tr>
							<tr>
								<td width="1%"></td>
								<td width="3%" valign="top">
									<cs:fieldLabel 
										value="#{message['MICOS.issues.observationSetup.label.Recommendation']}" 
										/>
								</td>
								<td width="2%" align="right" valign="top">	
												<h:graphicImage  
												alt="#{message['MICOS.Issues.observationDetails.help.recommendation']}" 
												url="${weblet:resource('com.csg.jsf.micIcons','/ico_info_question_16_cli.gif')}" 
												/>
											</td>
								<td width="15%">
									<h:outputText value="&#160;" />
									<h:outputText value="&#160;" />	
									<h:inputTextarea  
													display="mutable" style="width:38em;"
													readonly="false"
													value="#{observationSetupController.helper.recommendation.recommendation}" 
													rows="3" cols="75" length="4000"/>
									
								</td>
							</tr>
						</table>
						<table>
							<tr> 
								<td width="20%"></td>
								<td width="1%">							
									<h:commandButton 
										action="#{observationSetupController.observationCancel}" 
										onclick="if (!confirm('Are you sure you want to move to the observation setup page?All unsaved changes will be lost')) return false" 
										value="#{message['MICOS.issues.observationSetup.button.cancel']}" 
										rendered="#{observationSetupController.flagHelper.renderText}" 
										style="height:21px; width:100px;" >
										<f:param 
											value="observationSetupController.observation.id" 
											name="readObservationId" />
									</h:commandButton>
									<h:outputText value="&#160;" />
									<h:outputText value="&#160;" />
								</td>
								<td width="1%">
									<h:commandButton 
										action="#{observationSetupController.saveRecommendation}" 
										value="#{message['MICOS.issues.observationSetup.button.create']}" 
										rendered="#{observationSetupController.flagHelper.renderText}" 
										style="height:21px; width:100px;" />
								</td>
							</tr>
						</table>
					</c:if>
				</td></tr></table>  
			</cs:container> 
			<div class="toolbar">
				   <h:commandButton 
					action="#{observationSetupController.observationOverview}"
					value="#{message['MICOS.issues.createEditObservation.button.observationOverview']}"
					styleClass="button" /> 
			</div>
		</h:form>
	</ui:define>
</ui:composition>
</html>
